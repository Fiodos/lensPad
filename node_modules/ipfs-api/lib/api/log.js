'use strict';

var ndjson = require('ndjson');

module.exports = function (send) {
  return {
    tail: function tail(cb) {
      if (typeof cb !== 'function' && typeof Promise !== 'undefined') {
        return send('log/tail', null, {}, null, false).then(function (res) {
          return res.pipe(ndjson.parse());
        });
      }

      return send('log/tail', null, {}, null, false, function (err, res) {
        if (err) return cb(err);
        cb(null, res.pipe(ndjson.parse()));
      });
    }
  };
};