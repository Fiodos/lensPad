Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@urql/core"),t=require("react"),n=require("wonka"),r=e.createClient({url:"/graphql"}),u=t.createContext(r),o=u.Provider,i=u.Consumer;function c(){return t.useContext(u)}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}u.displayName="UrqlContext";var s={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function f(e,t){var n=a({},e,t,{data:void 0!==t.data||t.error?t.data:e.data,fetching:!!t.fetching,stale:!!t.stale});return function(e,t){if("object"!=typeof e||"object"!=typeof t)return e!==t;for(var n in e)if(!(n in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}(e,n)?n:e}function l(e,t){for(var n=0,r=t.length;n<r;n++)if(e[n]!==t[n])return!0;return!1}function p(r){var u=t.useRef(!0),o=c(),i=t.useState(s),f=i[0],l=i[1],p=t.useCallback((function(t,i){return l(a({},s,{fetching:!0})),n.toPromise(o.executeMutation(e.createRequest(r,t),i||{})).then((function(e){return u.current&&l({fetching:!1,stale:!!e.stale,data:e.data,error:e.error,extensions:e.extensions,operation:e.operation}),e}))}),[o,r,l]);return t.useEffect((function(){return u.current=!0,function(){u.current=!1}}),[]),[f,p]}function v(n,r){var u=t.useRef(void 0);return t.useMemo((function(){var t=e.createRequest(n,r);return void 0!==u.current&&u.current.key===t.key?u.current:(u.current=t,t)}),[n,r])}var d=!1;function x(e){var r=c(),u=function(e){if(!e._react){var t=new Set,r=new Map;e.operations$&&n.subscribe((function(e){"teardown"===e.kind&&t.has(e.key)&&(t.delete(e.key),r.delete(e.key))}))(e.operations$),e._react={get:function(e){return r.get(e)},set:function(e,n){t.delete(e),r.set(e,n)},dispose:function(e){t.add(e)}}}return e._react}(r),o=function(e,t){return e.suspense&&(!t||!1!==t.suspense)}(r,e.context),i=v(e.query,e.variables),p=t.useMemo((function(){if(e.pause)return null;var t=r.executeQuery(i,a({},{requestPolicy:e.requestPolicy},e.context));return o?n.onPush((function(e){u.set(i.key,e)}))(t):t}),[u,r,i,o,e.pause,e.requestPolicy,e.context]),x=t.useCallback((function(e,t){if(!e)return{fetching:!1};var r=u.get(i.key);if(r){if(t&&null!=r&&"then"in r)throw r}else{var o,c=n.subscribe((function(e){r=e,o&&o(r)}))(n.takeWhile((function(){return t&&!o||!r}))(e));if(null==r&&t){var a=new Promise((function(e){o=e}));throw u.set(i.key,a),a}c.unsubscribe()}return r||{fetching:!0}}),[u,i]),y=[r,i,e.requestPolicy,e.context,e.pause],b=t.useState((function(){d=!0;try{return[p,f(s,x(p,o)),y]}finally{d=!1}})),h=b[0],g=b[1],k=h[1];p!==h[0]&&l(h[2],y)&&g([p,k=f(h[1],x(p,o)),y]),t.useEffect((function(){var e=h[0],t=h[2][1],r=!1;function o(e){r=!0,d||g((function(t){var n=f(t[1],e);return t[1]!==n?[t[0],n,t[2]]:t}))}if(e){var i=n.subscribe(o)(n.onEnd((function(){o({fetching:!1})}))(e));return r||o({fetching:!0}),function(){u.dispose(t.key),i.unsubscribe()}}o({fetching:!1})}),[u,h[0],h[2][1]]);var q=t.useCallback((function(t){var c=a({},{requestPolicy:e.requestPolicy},e.context,t);g((function(e){return[o?n.onPush((function(e){u.set(i.key,e)}))(r.executeQuery(i,c)):r.executeQuery(i,c),e[1],y]}))}),[r,u,i,o,x,e.requestPolicy,e.context]);return[k,q]}function y(e,r){var u=c(),o=v(e.query,e.variables),i=t.useRef(r);i.current=r;var p=t.useMemo((function(){return e.pause?null:u.executeSubscription(o,e.context)}),[u,o,e.pause,e.context]),d=[u,o,e.context,e.pause],x=t.useState((function(){return[p,a({},s,{fetching:!!p}),d]})),y=x[0],b=x[1],h=y[1];p!==y[0]&&l(y[2],d)&&b([p,h=f(y[1],{fetching:!!p}),d]),t.useEffect((function(){function e(e){b((function(t){var n=f(t[1],e);return t[1]===n?t:(i.current&&t[1].data!==n.data&&(n.data=i.current(t[1].data,n.data)),[t[0],n,t[2]])}))}if(y[0])return n.subscribe(e)(n.onEnd((function(){e({fetching:!1})}))(y[0])).unsubscribe;e({fetching:!1})}),[y[0]]);var g=t.useCallback((function(t){var n=u.executeSubscription(o,a({},e.context,t));b((function(e){return[n,e[1],d]}))}),[u,e.context,o]);return[h,g]}exports.Consumer=i,exports.Context=u,exports.Mutation=function(e){var t=p(e.query);return e.children(a({},t[0],{executeMutation:t[1]}))},exports.Provider=o,exports.Query=function(e){var t=x(e);return e.children(a({},t[0],{executeQuery:t[1]}))},exports.Subscription=function(e){var t=y(e,e.handler);return e.children(a({},t[0],{executeSubscription:t[1]}))},exports.useClient=c,exports.useMutation=p,exports.useQuery=x,exports.useSubscription=y,Object.keys(e).forEach((function(t){"default"===t||exports.hasOwnProperty(t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return e[t]}})}));
//# sourceMappingURL=urql.min.js.map
